---
title: "Gaussian Mixtures in R"
abstract: >
  Gaussian mixture models (GMMs) are widely used for modelling stochastic problems. Indeed, a wide diversity of packages have been developed in R. However, no recent review describing the main features offered by these packages and comparing their performances has been performed. In this article, we first introduce the GMM and the EM algorithm used to retrieve the parameters of the model and analyse the main features implemented among seven of the most widely used R packages. We then empirically compare their statistical and computational performances in relation with the choice of the initialisation algorithm and the complexity of the mixture. 
  We demonstrate that the best estimation with well-separated components or with a small number of components with distinguishable modes is obtained with REBMIX initialisation, implemented in the \CRANpkg{rebmix} package, while the best estimation with highly overlapping components is obtained with *k*-means or random initialisation. Importantly, we show that implementation details in the EM algorithm yield differences in the parameters' estimation. Especially, packages \CRANpkg{mixtools} [@R-mixtools]  and \CRANpkg{Rmixmod} [@R-Rmixmod]  estimate the parameters of the mixture with smaller bias, while the RMSE and variability of the estimates is smaller with packages \CRANpkg{bgmm} [@R-bgmm] , \CRANpkg{EMCluster} [@R-EMCluster] , \CRANpkg{GMKMcharlie} [@R-GMKMcharlie] , \CRANpkg{flexmix} [@R-flexmix]  and \CRANpkg{mclust} [@R-mclust] . 
  The comparison of these packages provides R users with useful recommendations for improving the computational and statistical performance of their clustering and for identifying  common deficiencies. Additionally, we propose several improvements in the development of a future, unified mixture model package.
draft: true
author:  
  - name: Bastien Chassagnol
    affiliation: Laboratoire de Probabilités, Statistiques et Modélisation (LPSM), UMR CNRS 8001
    address:
    - 4 Place Jussieu Sorbonne Université
    - 75005, Paris, France
    orcid: 0000-0002-8955-2391
    email:  bastien_chassagnol@laposte.net
  - name: Antoine Bichat
    affiliation: Les Laboratoires Servier
    address:
    - 50 Rue Carnot
    - 92150, Suresnes, France
    url: https://rdrr.io/github/abichat/abutils/
    orcid: 0000-0001-6599-7081
    email: antoine.bichat@servier.com
  - name: Cheïma Boudjeniba
    affiliation: Systems Biology Group, Dept. of Computational Biology, Institut Pasteur
    address:
    - 25 Rue du Dr Roux
    - 75015 Paris
    email: cheima.boudjeniba@servier.com
  - name: Pierre-Henri Wuillemin
    affiliation: Laboratoire d'Informatique de Paris 6 (LIP6), UMR 7606
    address:
    - 4 Place Jussieu Sorbonne Université
    - 75005, Paris, France
    url: http://www-desir.lip6.fr/~phw/
    orcid: 0000-0003-3691-4886
    email:  pierre-henri.wuillemin@lip6.fr
  - name: Mickaël Guedj
    affiliation: Les Laboratoires Servier
    address:
    - 50 Rue Carnot
    - 92150, Suresnes, France
    url: https://michaelguedj.github.io/
    orcid: 0000-0001-6694-0554
    email: mickael.guedj@gmail.com
  - name: Gregory Nuel
    affiliation: Laboratoire de Probabilités, Statistiques et Modélisation (LPSM), UMR CNRS 8001
    address:
    - 4 Place Jussieu Sorbonne Université
    - 75005, Paris, France
    url: http://nuel.perso.math.cnrs.fr/
    orcid: 0000-0001-9910-2354
    email:  Gregory.Nuel@math.cnrs.fr
  - name: Etienne Becht
    affiliation: Les Laboratoires Servier
    address:
    - 50 Rue Carnot
    - 92150, Suresnes, France
    orcid: 0000-0003-1859-9202
    email: etienne.becht@servier.com
type: package
output: 
  rjtools::rjournal_web_article:
    self_contained: yes
    toc: no
    css: style_bastien.css
date: "`r Sys.Date()`"
header-includes:
  - \usepackage[most]{tcolorbox}
  - \usepackage[list=off, singlelinecheck=off, parskip=5pt]{caption}
  - \usepackage{booktabs}
  - \usepackage{bm, amsmath}
  - \usepackage{array}
  - \usepackage{multirow}
  - \usepackage{wrapfig}
  - \usepackage{float}
  - \usepackage{colortbl}
  - \usepackage{hhline}
  - \usepackage{xcolor}
  - \usepackage{longtable}
  - \usepackage{tabu}
  - \usepackage{adjustbox}
  - \usepackage{threeparttable}
  - \usepackage{makecell}
  - \def\greentick{\includegraphics[scale=0.05]{figs/green_tick.png}}
  - \def\redcross{\includegraphics[scale=0.05]{figs/red_cross.png}}
  - \newtcolorbox{blackbox}[1]{colback=white, colframe=black, coltext=black, boxsep=1.5pt, arc=4pt, before=\centering, title=#1}
  - \newenvironment{cols}[1][]{}{} \newenvironment{col}[1]{\begin{minipage}{#1}\ignorespaces}{\end{minipage} \ifhmode\unskip\fi
  - \aftergroup\useignorespacesandallpars} \def\useignorespacesandallpars#1\ignorespaces\fi{#1\fi\ignorespacesandallpars} \makeatletter  
  - \def\ignorespacesandallpars{\@ifnextchar\par {\expandafter\ignorespacesandallpars\@gobble} {} } \makeatother
bibliography: RJreferences.bib
zotero: false
editor_options: 
  markdown: 
    wrap: 72
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
	echo = FALSE,
	warning = FALSE, 
	message = FALSE,
	fig.align = "center",
	fig.cap.pre = "Figure ",
	fig.cap.sep = ": ",
	message = FALSE,
	warning = FALSE,
	out.width = "100%",
	tab.cap.pre = "Table ",
	tab.cap.sep = ": ",
	fig.cap.pre = "Figure ",
	fig.cap.sep = ": ")

library(ggplot2)
library(dplyr)
library(flextable)
library(kableExtra)
library(downlit)
library(RGMMBench)

options(dplyr.summarise.inform = FALSE) # remove the override .groups argument
```

```{r param-multivariate-gaussian}
data <- readr::read_delim("./tables/parametrisation_multivariate_gaussian.csv", delim=",", show_col_types = F) %>%
  mutate(Representation="",
         dplyr::across(.cols = c("Notation", "Number of parameters"), ~ paste0("$", .x, "$")))
Representation <- file.path("./tables", "gaussian_param",paste0(data$Model, ".png"))


data %>% kbl(booktabs=T, caption = "The 14 canonical parametrisations of the within-group covariance matrix $\\boldsymbol{\\Sigma_j}$ with the corresponding geometric representations.", escape=F) %>%
  kable_styling(latex_options=c("scale_down")) %>%
  row_spec(0,bold=T, align = "c") %>%
  row_spec(1:14, align = "c", hline_after = T) %>%
  column_spec(6, image=spec_image(Representation, 600, 350, res=600)) %>%
  column_spec(column = 1:6, width = c("2cm", "3cm", "3cm", "2cm", "4.5cm", "6.5cm"), latex_valign = "m")
```
